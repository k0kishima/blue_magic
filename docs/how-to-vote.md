## 自動投票

### 1. 予想マスタを作成する

自動投票は予め設定しておいた条件のレースや買い目があった場合に実行されます。  

以下、自動投票のための設定に関するモデルを予想マスタと呼びます。  
レースやオッズの選択だけではなく、1Rあたりの購入金額なども予想マスタの特定のモデルにて設定します。

※ TODO: ここを修正（「シミュレーションの実施」の２章をちゃんと作ってリンクする）

### 2. テレボートエージェントを有効にする

ボートレースのネット投票サービスであるテレボートは、現時点では自動投票には対応していません。  
従って、そういった機能をスクラッチ実装しなければいけません。

自動投票のためのAPIは以下のリポジトリになります。

- https://github.com/k0kishima/teleboat_agent

シンプルなAPIなのでREADMEに記載してある手順で簡単に環境構築できると思います。

ただ、ここで環境変数で設定した認証キーをクライアント側（このリポジトリ）で利用するので覚えておく必要があります。

### 3. 環境変数の設定

前節で構築したテレボートエージェントに疎通するために環境変数の設定を行います。  
設定が必要な値は以下です。

- `TELEBOAT_AGENT_API_BASE_URL`
- `TELEBOAT_AGENT_API_APPLICATION_TOKEN`

### 4. 自動投票の有効化

```bash
docker-compose exec app bundle exec rails runner 'Setting.voting_enable = true'
```

この類の設定は[管理画面](https://github.com/k0kishima/blue_magic_front)からも行えます。

**ここまでくると、テレボートに残高があって投票を受付中のレースが予想マスタにターゲッティングされたら実際に投票されるようになってますのでご注意ください。**
